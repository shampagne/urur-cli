# Testing Strategy

## テスト実装タイミング

テストは**実装前**に書く（TDD）。

```
仕様 → テスト（RED） → 実装（GREEN） → リファクタ
```

## 機能別テスト要件

### 必須（実装前にテストを書く）

| 機能タイプ | テスト種別 | 例 |
|-----------|----------|-----|
| 認証 | ユニット + 統合 | トークン保存/読込/削除 |
| バリデーション | ユニット | フォーム入力検証 |
| コマンド実行 | 統合 | コマンドの引数処理、出力 |
| Supabase操作 | 統合 | データ投稿、ユーザー情報取得 |
| 型定義 | ユニット | インターフェース検証 |

### 推奨（実装後でも可）

| 機能タイプ | テスト種別 | 例 |
|-----------|----------|-----|
| CLI出力 | スナップショット | ヘルプ表示、エラーメッセージ |
| エラーハンドリング | ユニット | ネットワークエラー、認証エラー |

## テストファイル配置

```
tests/
├── lib/
│   ├── validation.test.ts
│   ├── auth.test.ts
│   └── config.test.ts
└── commands/
    ├── login.test.ts
    └── submit.test.ts
```

## テスト実行タイミング

| フック | 実行内容 |
|-------|---------|
| pre-commit | lint + ユニットテスト |
| pre-push | 全テスト |

## 品質基準

- 新機能: 対応するテストなしでマージ不可
- バグ修正: 再発防止テストを追加
- リファクタ: 既存テストが通ること

## テスト命名規則

```typescript
describe('関数名/モジュール名', () => {
  it('should 期待する動作', () => {})
  it('should エッジケースの動作', () => {})
})
```
